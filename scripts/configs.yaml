defaults:

  # Experiment Setup
  seed: 42
  logroot: logs
  expname: test
  logdir: ""
  filter: '.*'

  # Jax Configuration
  jax:
    platform: gpu
    jit: True
    compute_dtype: bfloat16 # bfloat16, float32
    param_dtype: float32
    prealloc: True
    checks: False
    logical_cpus: 0
    debug: False
    train_devices: [0]
    sync_every: 1
    profiler: False
    transfer_guard: True
    assert_num_devices: -1
    fetch_policy_carry: False
    nvidia_flags: False
    xla_dump: False

  # Experiment Running Mastermind Config
  run:
    script: train
    steps: 1000000 # train steps
    duration: 0
    log_every: 120
    save_every: 900
    eval_every: 180
    log_zeros: True
    from_checkpoint: ''
    usage: {psutil: True, nvsmi: True, gputil: False, malloc: False, gc: False}
    timer: True

  # Models, Training, and Hyperparameters
  diffuser: {beta_start: 0.0001, beta_final: 0.02, stage: 3, steps: 1000, thidden: 512, ahidden: 128, hidden: 128, head: 8, group: 8, act: silu}
  opt: {lr: 3e-4}
  image_size: [64, 64]
  dir_path: "/dev/null"
  path_A: ""
  path_B: ""
  batch_size: 16
  loss_scales: {diffuser: 1.0}


tiny:
  diffuser: {steps: 1000, thidden: 256, ahidden: 128, hidden: 128, head: 8, group: 8}

small:
  diffuser: {steps: 1200, thidden: 512, ahidden: 256, hidden: 256, head: 8, group: 8}

large:
  diffuser: {steps: 1400, thidden: 1024, ahidden: 512, hidden: 512, head: 8, group: 8}

monet:
  dir_path: "data/monet_jpg"

photo:
  dir_path: "data/photo_jpg"

elefant:
  dir_path: "elefant"

m2p:
  dir_path: ""
  path_A: "data/monet_jpg"
  path_B: "data/photo_jpg"